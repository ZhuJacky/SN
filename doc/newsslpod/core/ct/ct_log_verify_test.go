package ct

import (
	"encoding/pem"
	"fmt"
	"testing"
	"time"

	"github.com/google/certificate-transparency-go/x509"
	"github.com/stretchr/testify/assert"
)

func TestTimeSub(t *testing.T) {

	notBefore := time.Date(2018, 11, 0, 0, 0, 0, 0, time.UTC)
	notBefore2 := time.Date(2018, 12, 0, 0, 0, 0, 0, time.UTC)
	notAfter := time.Date(2020, 3, 1, -24, 0, 0, 0, time.UTC)

	fmt.Println(notAfter.Sub(notBefore).Hours() / 24.00 / 31.00)
	fmt.Println(notBefore.AddDate(0, 15, 0).Sub(notAfter).Hours() / 24)
	fmt.Println(notAfter.Sub(notBefore2).Hours() / 24.00 / 31.00)
	fmt.Println(notBefore2.AddDate(0, 15, 0).Sub(notAfter).Hours() / 24)
}

var testTimeData = []struct {
	Tags   string
	Time   time.Time
	Expect int
}{
	{Tags: "1", Time: time.Date(2018, 11, 29, 0, 0, 0, 0, time.UTC), Expect: 29},
	{Tags: "2", Time: time.Date(2018, 12, 21, 0, 0, 0, 0, time.UTC), Expect: 21},
	{Tags: "3", Time: time.Date(2020, 3, 4, 0, 0, 0, 0, time.UTC), Expect: 4},
	{Tags: "4", Time: time.Date(2020, 1, 1, 25, 0, 0, 0, time.UTC), Expect: 2},
	{Tags: "5", Time: time.Date(2020, 2, 29, 0, 0, 0, 0, time.UTC), Expect: 29},
}

func Test_monthDay(t *testing.T) {
	for _, v := range testTimeData {
		assert.Equal(t, v.Expect, monthDay(v.Time), v.Tags)
	}
}

var tlsSCTExt = []byte{
	// 0x00, 0x12,
	0x00, 0xf0,
	0x00, 0xee, 0x00, 0x75, 0x00, 0xdb, 0x74, 0xaf, 0xee, 0xcb, 0x29, 0xec,
	0xb1, 0xfe, 0xca, 0x3e, 0x71, 0x6d, 0x2c, 0xe5, 0xb9, 0xaa, 0xbb, 0x36, 0xf7, 0x84, 0x71, 0x83,
	0xc7, 0x5d, 0x9d, 0x4f, 0x37, 0xb6, 0x1f, 0xbf, 0x64, 0x00, 0x00, 0x01, 0x64, 0x99, 0xbf, 0xba,
	0x99, 0x00, 0x00, 0x04, 0x03, 0x00, 0x46, 0x30, 0x44, 0x02, 0x20, 0x0b, 0x74, 0x40, 0xd4, 0x42,
	0x03, 0x43, 0x5a, 0x01, 0xff, 0x86, 0x41, 0x46, 0xc8, 0x28, 0xfa, 0x14, 0x96, 0x78, 0x18, 0xbf,
	0x4d, 0xa7, 0x8d, 0x3c, 0x92, 0x6c, 0x15, 0xb8, 0x29, 0xf2, 0xab, 0x02, 0x20, 0x79, 0xe7, 0x34,
	0x6d, 0x3d, 0x18, 0x90, 0x4a, 0x02, 0xf2, 0xb9, 0x23, 0x22, 0xf8, 0x67, 0x80, 0x77, 0xf3, 0x55,
	0x77, 0x46, 0xfd, 0x09, 0x75, 0x1a, 0x54, 0x67, 0xd1, 0xc1, 0x73, 0xce, 0x5f, 0x00, 0x75, 0x00,
	0xc1, 0x16, 0x4a, 0xe0, 0xa7, 0x72, 0xd2, 0xd4, 0x39, 0x2d, 0xc8, 0x0a, 0xc1, 0x07, 0x70, 0xd4,
	0xf0, 0xc4, 0x9b, 0xde, 0x99, 0x1a, 0x48, 0x40, 0xc1, 0xfa, 0x07, 0x51, 0x64, 0xf6, 0x33, 0x60,
	0x00, 0x00, 0x01, 0x64, 0x99, 0xbf, 0xcb, 0x81, 0x00, 0x00, 0x04, 0x03, 0x00, 0x46, 0x30, 0x44,
	0x02, 0x20, 0x21, 0x56, 0x2c, 0xd0, 0xb0, 0x7d, 0x86, 0x0d, 0xed, 0x98, 0x8e, 0x6d, 0x57, 0x5b,
	0x03, 0xc8, 0x4f, 0x18, 0x3b, 0x22, 0x70, 0xa9, 0xcc, 0xd4, 0x12, 0xca, 0x76, 0x3a, 0x4f, 0x4a,
	0xb5, 0x7b, 0x02, 0x20, 0x2f, 0x45, 0x44, 0x2d, 0xf7, 0x3e, 0x59, 0x32, 0x40, 0x3d, 0x8e, 0xf0,
	0x25, 0xbd, 0xf7, 0xd2, 0x74, 0x3a, 0x5d, 0xe6, 0x27, 0x47, 0x33, 0xd1, 0x11, 0x7f, 0x11, 0x41,
	0x45, 0xdd, 0xf3, 0x4b,
}

var x509SCTExt = []byte{
	0x04, 0x81,
	0xf1,
	0x00, 0xef,
	0x00, 0x76, 0x00, 0x29, 0x3c, 0x51, 0x96, 0x54, 0xc8, 0x39, 0x65, 0xba, 0xaa, 0x50, 0xfc, 0x58,
	0x07, 0xd4, 0xb7, 0x6f, 0xbf, 0x58, 0x7a, 0x29, 0x72, 0xdc, 0xa4, 0xc3, 0x0c, 0xf4, 0xe5, 0x45,
	0x47, 0xf4, 0x78, 0x00, 0x00, 0x01, 0x64, 0x99, 0x9e, 0x44, 0xa6, 0x00, 0x00, 0x04, 0x03, 0x00,
	0x47, 0x30, 0x45, 0x02, 0x20, 0x67, 0xe8, 0xf5, 0x34, 0x64, 0xbe, 0x4e, 0x1b, 0xed, 0xf7, 0x05,
	0xe4, 0x01, 0x3a, 0x6a, 0xd1, 0xe5, 0x9c, 0xcf, 0x9f, 0x75, 0xa1, 0x04, 0xc7, 0x27, 0xe3, 0x23,
	0xfa, 0xa2, 0x88, 0x57, 0x35, 0x02, 0x21, 0x00, 0xc4, 0x46, 0xe4, 0xea, 0x14, 0x83, 0x73, 0xc4,
	0x37, 0xce, 0xdf, 0xe8, 0x33, 0xe2, 0x4e, 0x10, 0x4b, 0x54, 0xea, 0x43, 0x3d, 0x51, 0x4c, 0x45,
	0x2c, 0x1f, 0x32, 0x44, 0x8f, 0x6e, 0x3a, 0x26,
	0x00, 0x75, 0x00, 0x55, 0x81, 0xd4, 0xc2, 0x16, 0x90, 0x36, 0x01, 0x4a, 0xea, 0x0b, 0x9b, 0x57,
	0x3c, 0x53, 0xf0, 0xc0, 0xe4, 0x38, 0x78, 0x70, 0x25, 0x08, 0x17, 0x2f, 0xa3, 0xaa, 0x1d, 0x07,
	0x13, 0xd3, 0x0c, 0x00, 0x00, 0x01, 0x64, 0x99, 0x9e, 0x45, 0x89, 0x00, 0x00, 0x04, 0x03, 0x00,
	0x46, 0x30, 0x44, 0x02, 0x20, 0x55, 0xc5, 0x41, 0x5b, 0xf8, 0xed, 0xd6, 0x4a, 0xde, 0x3c, 0x58,
	0x81, 0xfa, 0x71, 0x64, 0xc1, 0x25, 0xed, 0xfe, 0x57, 0x28, 0x26, 0xf6, 0x70, 0xe1, 0x10, 0xe5,
	0x31, 0x4a, 0xc1, 0x31, 0xb4, 0x02, 0x20, 0x2c, 0x46, 0x0d, 0xca, 0xc3, 0x7c, 0xe1, 0x3f, 0x06,
	0xe7, 0x28, 0xac, 0xd4, 0xf5, 0x74, 0x81, 0x0f, 0xe1, 0x07, 0x48, 0x26, 0xac, 0xa6, 0x54, 0x61,
	0x88, 0x39, 0x1d, 0xe2, 0x71, 0x0e, 0xdf,
}

var cert = `-----BEGIN CERTIFICATE-----
MIIFlzCCBH+gAwIBAgISA+SIGqgR9iMLtAyLnT9EOnmSMA0GCSqGSIb3DQEBCwUA
MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD
ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xODA3MTQxNTI3MjNaFw0x
ODEwMTIxNTI3MjNaMBQxEjAQBgNVBAMTCXJhemVlbi5tZTB2MBAGByqGSM49AgEG
BSuBBAAiA2IABCHXXyPKdj0qRZFfRFyrOZ0bX3DcXEku9NbI7RfMJjKmY9Vi0c8A
zKe/85cMZymJI1DAkXJn/4Ds9H4xNrl1tc+p1JEN6ZAfxEIgVbp6apiO25XPMGRI
m/iHQUw0Tevwq6OCA1kwggNVMA4GA1UdDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggr
BgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUz6fl7IkQ
kaNWDX9nCa3cacgVc9kwHwYDVR0jBBgwFoAUqEpqYwR93brm0Tm3pkVl7/Oo7KEw
bwYIKwYBBQUHAQEEYzBhMC4GCCsGAQUFBzABhiJodHRwOi8vb2NzcC5pbnQteDMu
bGV0c2VuY3J5cHQub3JnMC8GCCsGAQUFBzAChiNodHRwOi8vY2VydC5pbnQteDMu
bGV0c2VuY3J5cHQub3JnLzBdBgNVHREEVjBUggsqLnJhemVlbi5jboILKi5yYXpl
ZW4ubWWCESoucmF6ZWVuY2hlbmcuY29tgglyYXplZW4uY26CCXJhemVlbi5tZYIP
cmF6ZWVuY2hlbmcuY29tMIH+BgNVHSAEgfYwgfMwCAYGZ4EMAQIBMIHmBgsrBgEE
AYLfEwEBATCB1jAmBggrBgEFBQcCARYaaHR0cDovL2Nwcy5sZXRzZW5jcnlwdC5v
cmcwgasGCCsGAQUFBwICMIGeDIGbVGhpcyBDZXJ0aWZpY2F0ZSBtYXkgb25seSBi
ZSByZWxpZWQgdXBvbiBieSBSZWx5aW5nIFBhcnRpZXMgYW5kIG9ubHkgaW4gYWNj
b3JkYW5jZSB3aXRoIHRoZSBDZXJ0aWZpY2F0ZSBQb2xpY3kgZm91bmQgYXQgaHR0
cHM6Ly9sZXRzZW5jcnlwdC5vcmcvcmVwb3NpdG9yeS8wggEDBgorBgEEAdZ5AgQC
BIH0BIHxAO8AdgApPFGWVMg5ZbqqUPxYB9S3b79Yeily3KTDDPTlRUf0eAAAAWSZ
nkSmAAAEAwBHMEUCIGfo9TRkvk4b7fcF5AE6atHlnM+fdaEExyfjI/qiiFc1AiEA
xEbk6hSDc8Q3zt/oM+JOEEtU6kM9UUxFLB8yRI9uOiYAdQBVgdTCFpA2AUrqC5tX
PFPwwOQ4eHAlCBcvo6odBxPTDAAAAWSZnkWJAAAEAwBGMEQCIFXFQVv47dZK3jxY
gfpxZMEl7f5XKCb2cOEQ5TFKwTG0AiAsRg3Kw3zhPwbnKKzU9XSBD+EHSCasplRh
iDkd4nEO3zANBgkqhkiG9w0BAQsFAAOCAQEAl0yisUNTwFWCqR/Gbk+TjTe3Q4Tt
NaogMdkcu/rcT4qBJV+MRUdDs1pYA6ZWntreHkgf/8TtMxBjB2Q55XgCwpwGZSaC
8nfFfFewhGCcrNcqIM2pUWBylXa/YiU6d5MO1H0Ktad8HEk3RaMDW0UudQmo/VVn
xfQHfzpc5P1wV8oOIAsGC38Vp23JMTdTOFw8BWC8RZOfWGpiuR5az+sg0n/Nbtlg
04yyOQDC7IO+qSwk0hyBYMVcM5CJwTXyYtiAINGaOVkc2WWSXjgbatZBqHKumh1p
7V5s/EiQbMRLwCgaS8sz0NqeRuZNtVXRYLPB8c0PmJr1Yb3gcyJj/pNlCQ==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/
MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
DkRTVCBSb290IENBIFgzMB4XDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0Nlow
SjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxIzAhBgNVBAMT
GkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4S0EF
q6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8
SMx+yk13EiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0
Z8h/pZq4UmEUEz9l6YKHy9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWA
a6xK8xuQSXgvopZPKiAlKQTGdMDQMc2PMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj
/PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQABo4IBfTCCAXkwEgYDVR0T
AQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEEczBxMDIG
CCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNv
bTA7BggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9k
c3Ryb290Y2F4My5wN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAw
VAYDVR0gBE0wSzAIBgZngQwBAgEwPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcC
ARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNyeXB0Lm9yZzA8BgNVHR8ENTAz
MDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9PVENBWDNDUkwu
Y3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsF
AAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJo
uM2VcGfl96S8TihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/
wApIvJSwtmVi4MFU5aMqrSDE6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwu
X4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPMTZ+sOPAveyxindmjkW8lGy+QsRlG
PfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M+X+Q7UNKEkROb3N6
KOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==
-----END CERTIFICATE-----`

func TestParseCertificateTransparencyInfo(t *testing.T) {
	rest := []byte(testKnownsec)
	certs := [][]byte{}
	for rest != nil {
		var p *pem.Block
		p, rest = pem.Decode(rest)
		if p == nil {
			break
		}
		certs = append(certs, p.Bytes)
	}

	leaf, _ := x509.ParseCertificate(certs[0])
	issuer, _ := x509.ParseCertificate(certs[1])

	assert := assert.New(t)
	info, err := ParseCertificateTransparencyInfo(nil, leaf, issuer)
	assert.Nil(err)

	for _, v := range info {
		t.Logf("%+v", v)
	}

}

func TestIsCTQualified(t *testing.T) {

	assert := assert.New(t)
	for _, testData := range isQualifiedTestDatas {
		rest := []byte(testData.Certs)
		certs := [][]byte{}
		for rest != nil {
			var p *pem.Block
			p, rest = pem.Decode(rest)
			if p == nil {
				break
			}
			certs = append(certs, p.Bytes)
		}

		res, err := IsCTQualified(testData.RawCTFromTLS, certs)
		assert.Nil(err)
		assert.Equal(testData.IsQualified, res.IsQualified, testData.Key)
		t.Logf("%+v", res.SCTS)
	}
}

type isQualifiedTestData struct {
	Key          string
	Certs        []byte
	RawCTFromTLS []byte
	IsQualified  int
}

var isQualifiedTestDatas = []*isQualifiedTestData{
	&isQualifiedTestData{Key: "", Certs: []byte(cert), RawCTFromTLS: tlsSCTExt, IsQualified: CTQualified},
	&isQualifiedTestData{Key: "2018年4月30号前发的2年，没有CT信息也不受影响", Certs: []byte(testCert2), RawCTFromTLS: nil, IsQualified: CTNotAffected},
	&isQualifiedTestData{Key: "新发的两年，已经包含3个SCT", Certs: []byte(testCert3), RawCTFromTLS: nil, IsQualified: CTQualified},
	&isQualifiedTestData{Key: "外交部邮件系统更新前的证书", Certs: []byte(testCert4), RawCTFromTLS: nil, IsQualified: CTNotQualified},
	&isQualifiedTestData{Key: "外交部邮件系统更新后的证书", Certs: []byte(testCert5), RawCTFromTLS: nil, IsQualified: CTQualified},
	&isQualifiedTestData{Key: "invalid-expected-sct.badssl.com", Certs: []byte(testCert6), RawCTFromTLS: nil, IsQualified: CTNotQualified},
	&isQualifiedTestData{Key: "www.2345.com", Certs: []byte(testCert7), RawCTFromTLS: nil, IsQualified: CTQualified},
	&isQualifiedTestData{Key: "www.knownsec.com", Certs: []byte(testKnownsec), RawCTFromTLS: nil, IsQualified: CTQualified},
}

var testKnownsec = `-----BEGIN CERTIFICATE-----
MIIGoDCCBYigAwIBAgIQCpTUTdRk8p02d4xbByGz0zANBgkqhkiG9w0BAQsFADBs
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJTZWN1cmUgU2l0ZSBFeHRlbmRlZCBW
YWxpZGF0aW9uIENBMB4XDTE4MTEzMDAwMDAwMFoXDTIwMDIyOTEyMDAwMFowgdYx
HTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRMwEQYLKwYBBAGCNzwCAQMT
AkNOMRswGQYDVQQFExI5MTExMDEwODY2NjI3NzYyMFkxCzAJBgNVBAYTAkNOMRIw
EAYDVQQIDAnljJfkuqzluIIxEjAQBgNVBAcMCeWMl+S6rOW4gjEzMDEGA1UECgwq
5YyX5Lqs55+l6YGT5Yib5a6H5L+h5oGv5oqA5pyv5pyJ6ZmQ5YWs5Y+4MRkwFwYD
VQQDExB3d3cua25vd25zZWMuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
CgKCAQEAqP7X4XFTKWMqZUt563QhwsDe7tduf4cmZRBz2k91y7Uih16ehyVHmpin
FJBdChqIYWgeC2O/mvTTGd4AY6gdDS0RA58HSHJMFM7NemN39dmVuwFfNxKBdN/B
ircv8O2CUG7BVPjTsz8huy8knLHM09d6Xat6vMOzXTVR31RecHXGh01rWxKVXFIW
hHCDVt78VpkFVHAEzLF2a4KJl2weWGlodaohZnvg8PcomQOy35LV6FWLgQXQ9Z3f
U96jzPwqJxWGL3IcEhq7xE/gFoK62ANnj587cqctK7zPocW4svpMFxJTF+Z7ey1p
1BYDGNLDbXAbWePgYLrxVS9Ou6ShjwIDAQABo4IC0TCCAs0wHwYDVR0jBBgwFoAU
qTu6eliVSDX+1gedK4sl/mrh26AwHQYDVR0OBBYEFNZ76eGC0TD+VK7t+YB+VsTD
lDOLMCkGA1UdEQQiMCCCEHd3dy5rbm93bnNlYy5jb22CDGtub3duc2VjLmNvbTAO
BgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMEwG
A1UdHwRFMEMwQaA/oD2GO2h0dHA6Ly9jZHAxLmRpZ2ljZXJ0LmNvbS9TZWN1cmVT
aXRlRXh0ZW5kZWRWYWxpZGF0aW9uQ0EuY3JsMEsGA1UdIAREMEIwNwYJYIZIAYb9
bAIBMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LmRpZ2ljZXJ0LmNvbS9DUFMw
BwYFZ4EMAQEwgYAGCCsGAQUFBwEBBHQwcjAhBggrBgEFBQcwAYYVaHR0cDovL29j
c3AuZGNvY3NwLmNuME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2Vy
dC1jbi5jb20vU2VjdXJlU2l0ZUV4dGVuZGVkVmFsaWRhdGlvbkNBLmNydDAJBgNV
HRMEAjAAMIIBBgYKKwYBBAHWeQIEAgSB9wSB9ADyAHcApLkJkLQYWBSHuxOizGdw
Cjw1mAT5G9+443fNDsgN3BAAAAFnY/t3LAAABAMASDBGAiEAnTkzuwPnrvzjAFR9
m7VgxLOSOkrvleGCRO/M82SkLUUCIQCOqju9GI3Nw9Z1wtELEMkwqUKp1yNnlLcZ
dIgeU6aXqQB3AFYUBpov18Ls0/XhvUSyPsdGdrm8mRFcwO+UmFXWidDdAAABZ2P7
d5sAAAQDAEgwRgIhAPHiijdpaH5p6kdsVkVfW2mllXsreYQfizN36fMepKYwAiEA
k/3qo7+b1dS4eb7ly6taK7YLx2YcqZAXNvF8OIEdvhkwDQYJKoZIhvcNAQELBQAD
ggEBAF67OhJBrLCT2/yGhyq5nnxA8fbQxuCF5dq0hhqHjqekWi0yK5LO7zqy2LmP
RvqOIJ2t05U95bM7xlXIaU0H+zg8GrXkjNToTXObbCALEa1BkI7aMsl1sUxsxRCY
aALmo03MqciVgvT2Edu35xJ+A9ph68KesxawP46UGAl7ybGjUl7CdNBZRknqt0z0
JKoyZ8Gu5RJ4KiGnpyj46ZkoxEdCCrGSuoMytiaj+otLYS6oeCQ35hdh1VXY0wn1
bBHAqU7Heo3OSvo1UZL5Nw+saJKmEzWhF7xNltC8URfiSQ7duevEZrroKqzXeSBO
2zOAEPiwr7RJVQdIG21lF5faQgY=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEsjCCA5qgAwIBAgIQAVCjBPPmQOwuDj3jWzGb8DANBgkqhkiG9w0BAQsFADBs
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j
ZSBFViBSb290IENBMB4XDTE4MDQyNzEyNDM0MFoXDTI4MDQyNzEyNDM0MFowbDEL
MAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3
LmRpZ2ljZXJ0LmNvbTErMCkGA1UEAxMiU2VjdXJlIFNpdGUgRXh0ZW5kZWQgVmFs
aWRhdGlvbiBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALfi6Mde
gU/YaWxmXJ9mYcvY5hbiqRZ221Nq+paGg9wQLnVzw7tpbisbCKQ5s4tnhdh28Jlq
rgqB9gneUqmITQI2mzeFyH02cjmKDjBxj8Misg0ld0GVV8cNVGPKaJ2/APCmHqSf
bTwybDWmf3Zq65ZYGTJVHbBeu7X8foqA19D2Jm9CO0CstO8fz92pmebbtRxH8L/5
wLvHIra+0xXJ+znyT2Tom2hNsYv4PkZYTYAbwx1hOZnaFXPP48X02zE3oVJAH+Q4
58SPmzH62ybCoh86knzcTJlI/62ZRWfkFe4W+Vp5BunaqZC65RuRDgTViScHIDqF
wVgscAiPF/DA2AUCAwEAAaOCAU4wggFKMB0GA1UdDgQWBBSpO7p6WJVINf7WB50r
iyX+auHboDAfBgNVHSMEGDAWgBSxPsNpA/i/RwHUmCYaCALvY2QrwzAOBgNVHQ8B
Af8EBAMCAYYwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB
/wQIMAYBAf8CAQAwNwYIKwYBBQUHAQEEKzApMCcGCCsGAQUFBzABhhtodHRwOi8v
b2NzcC5kaWdpY2VydC1jbi5jb20wTQYDVR0fBEYwRDBCoECgPoY8aHR0cDovL2Ny
bC5kaWdpY2VydC1jbi5jb20vRGlnaUNlcnRIaWdoQXNzdXJhbmNlRVZSb290Q0Eu
Y3JsMD0GA1UdIAQ2MDQwMgYEVR0gADAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3
dy5kaWdpY2VydC5jb20vQ1BTMA0GCSqGSIb3DQEBCwUAA4IBAQBgPjkD6SRybH59
YR4ppC6VwipnHQoBx0C4sorm3pO+edfUQOQ85BSrBFKsM7TqSf4V5olAEoyJggFF
DS7OTz5z94uwCKLbgC7rLON0Brnhdvi3l2DSHYdmLEmC31dKKW4LevAF9YKY2bmG
gLq2IZAX3RH1u6Bip4BM4zNYCcG8/Prvmmr/Y6hRuWb2iqxop2q/4ga58b6oj0VI
Pd6h/IGdg6DY4i8Myad3M3mFdeJ8hf1pfrvNSvkEUOujcvXqjsYqElj0kdbgYHxo
ouDg4tndKMjYPYWHVxFcoPNg4I7aInKQG1c1a6wu+v3iFpvz3tC73zrwy+Ypo8Ou
YFFcAoDG
-----END CERTIFICATE-----`

var testCert7 = `-----BEGIN CERTIFICATE-----
MIIHOzCCBiOgAwIBAgIQDUVVfZbV7QFcKKSwIcRi5DANBgkqhkiG9w0BAQsFADBY
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMRcwFQYDVQQDEw5TZWN1cmUgU2l0ZSBDQTAeFw0xODA4
MTUwMDAwMDBaFw0yMDExMTMxMjAwMDBaMHoxCzAJBgNVBAYTAkNOMQ8wDQYDVQQH
DAbkuIrmtbcxMzAxBgNVBAoMKuS4iua1t+S6jOS4ieWbm+S6lOe9kee7nOenkeaK
gOaciemZkOWFrOWPuDESMBAGA1UECwwJ6L+Q57u06YOoMREwDwYDVQQDEwgyMzQ1
LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOdN36VdQmFflIEY
NgvLpAesDvslHTBLpY5hofEs9RJEefJXHD1FCeapEG4S953tnOEfJlp2WHimLRe+
7J3gnu3S19cz80TWcgNPlG9yfrzXI36v69dAlbwzcx8HjAqOiSbUjy8CfR04KCj1
FZAIit0s9MrnNAyI7c/aJFuabGA6Q8HRkG5PjgwCojnzPeEaPS5z1AsWotV8twOa
U/ux8/JREqAc5eR9cJynnLMsa2grqWYJdYyZ1tVT7ei78Ru468u7yFTbGLW75ZJv
pMS5EeaSBDxmkCsME8OjLwjZhx9IwhF8oYj12QVHkGLKIrGY6DHxApoVWQJYelpC
XtEafYUCAwEAAaOCA90wggPZMB8GA1UdIwQYMBaAFMQRfohAhsJBv2XzGuG0U0Cj
q+x9MB0GA1UdDgQWBBRcFYfsVrk6xDSYbtmo/nRh/VonXjCB2gYDVR0RBIHSMIHP
gggyMzQ1LmNvbYIMd3d3LjIzNDUuY29tgg5teS5pZS4yMzQ1LmNvbYIQbmFtZS5p
ZS4yMzQ1LmNvbYIKKi4yMzQ1LmNvbYINYy5pZS4yMzQ1LmNvbYIMKi5oYW83NzQu
Y29tghdndWVzcy51bmlvbjIuNTBiYW5nLm9yZ4ITdXBkYXRlLmFwcC4yMzQ1LmNv
bYIHMjM0NS5jboIKNTBiYW5nLm9yZ4IOYXBpLnYuMjM0NS5jb22CCSouMjM0NS5j
boIMKi41MGJhbmcub3JnMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEF
BQcDAQYIKwYBBQUHAwIwPAYDVR0fBDUwMzAxoC+gLYYraHR0cDovL2NkcDEuZGln
aWNlcnQuY29tL1NlY3VyZVNpdGVDQS0xLmNybDBMBgNVHSAERTBDMDcGCWCGSAGG
/WwBATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BT
MAgGBmeBDAECAjByBggrBgEFBQcBAQRmMGQwJQYIKwYBBQUHMAGGGWh0dHA6Ly9v
Y3NwMS5kaWdpY2VydC5jb20wOwYIKwYBBQUHMAKGL2h0dHA6Ly9jYWNlcnRzLmRp
Z2ljZXJ0LWNuLmNvbS9TZWN1cmVTaXRlQ0EuY3J0MAkGA1UdEwQCMAAwggF+Bgor
BgEEAdZ5AgQCBIIBbgSCAWoBaAB2AKS5CZC0GFgUh7sTosxncAo8NZgE+RvfuON3
zQ7IDdwQAAABZTw5I08AAAQDAEcwRQIgOmQQWNykk1407F9RwGD/v4nFuLHwPk1D
vn6fpp6C5WECIQDt9+/u/ZZCUElPWLamrREuNJXEeg6CFbX+2slufmmpwAB2AId1
v+dZfPiMQ5lfvfNu/1aNR1Y2/0q1YMG06v9eoIMPAAABZTw5JCgAAAQDAEcwRQIh
AKpFZQlL6SukZ6vjZlHARdxHnvsk5wmTwBZNtALjBtLKAiAdoc+LvektYKFrPzxR
AKvGRugSmYvcj/DG8A6mHKGtAQB2ALvZ37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCW
ZDaOHtGFAAABZTw5JDoAAAQDAEcwRQIgcN2VRYbEuQIzYYmfCbF/zJN76+g/7/W7
Nf96OtHW1e0CIQDI9n36LHysDEPYRRRkg1O38tliqYGGhsvK6O7o3yFHpjANBgkq
hkiG9w0BAQsFAAOCAQEAI1IXKFzmvwC5k65x33H7+MtdInHG77JtFlMk1aIm7JC8
egMtmZbOPCEzwsLt6xpC5QpCgPRp78HRl+bR3gQ832dqPK8YvCYAD8AYFjL14+cc
JJ6XE/QNgPSLi3cscsH3rM46i+zwy+WiAp3+YVlmF9x4IW/voG9ntqBX2kE8JeT4
7a3yG6BZIFfVFqYEg+NReE1pxb7ynojn/18pjmd3EOCzQd9WbMLPVjbRenRyOd+E
lgxQk/uTRAW2V3Gb0gyUwaSu1dnNBuXO2DxZd8Df4G08zGa755J4P+AeUatOFZTh
g/41Akqp3aU637tthQwo8AymctJyj6WuhXVRiLssQQ==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEozCCA4ugAwIBAgIQBdH8WS5y3RzQI80YGNqnHzANBgkqhkiG9w0BAQsFADBh
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD
QTAeFw0xODA1MTcxMjMwMTNaFw0zMDA1MTcxMjMwMTNaMFgxCzAJBgNVBAYTAlVT
MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5j
b20xFzAVBgNVBAMTDlNlY3VyZSBTaXRlIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAx7s903fR6SgpA08UdhKEUIZHa2Ig7KPNkTtwMS1+08YS5QSE
DM4DQxy48jP8dZkyyU9J/0WCm8Nlv5ga7HOAxhdJcv+CPP4oadx8EbdrmjAHrGOv
64oHvt7Ina7uzLd3krqxd0doeuxRpTHvFAyjaUhxjSfZx0wh1f6W7prPm7V50VcT
udj4rI+xtHXUcFAuFz4bcapTcru5aaZ1v6F2usMCMVM+xJxEZcsUM4uTxdIfW5FU
TI0dbP8NyZkr/WVzL59aGwBE4ZU0JKBlgEmtkFpLPR7JCzYunafu7nMk5YY26WDO
mezpWDjzDxJ8xakizykWYT5gdJYE3ULlUe31WQIDAQABo4IBXjCCAVowHQYDVR0O
BBYEFMQRfohAhsJBv2XzGuG0U0Cjq+x9MB8GA1UdIwQYMBaAFAPeUDVW0Uy7ZvCj
4hsbw5eyPdFVMA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYI
KwYBBQUHAwIwEgYDVR0TAQH/BAgwBgEB/wIBADA3BggrBgEFBQcBAQQrMCkwJwYI
KwYBBQUHMAGGG2h0dHA6Ly9vY3NwLmRpZ2ljZXJ0LWNuLmNvbTBEBgNVHR8EPTA7
MDmgN6A1hjNodHRwOi8vY3JsLmRpZ2ljZXJ0LWNuLmNvbS9EaWdpQ2VydEdsb2Jh
bFJvb3RDQS5jcmwwVgYDVR0gBE8wTTA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcC
ARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwCAYGZ4EM
AQIDMA0GCSqGSIb3DQEBCwUAA4IBAQDIiGcy9AiAa0e41RwQxUUs9uukRK8H5ekg
gREh38fJ4vAjYliu6t5VjNSI4+yzXVw0sy8JmaHzOs5A7AqqOsovIwJxP5/MMAh7
U/K9QWeD5mqRpWUi9vluwqQPEtK4tgZt1s99RezAUK8Jtjfn5UmUxUh6ET4lxyDe
0NhgxpfsWsgeYgwYEGrODa6fHQTpmxGTzyNvjUIR4de09NfRoCUWUumjNMLdaLqf
Vv6kRihaDDZc2bjoANtTUJ2lyHZJqo0mAVs6gZJ4Jl7SgtdxfnkxHuzDrjWxwo98
VueqqRBUewSmweO+btngjVd6Gj3E99EGIJq3k9k4HXPUaRJLQ3qY
-----END CERTIFICATE-----`

// invalid-expected-sct.badssl.com
var testCert6 = `-----BEGIN CERTIFICATE-----
MIIFGDCCBACgAwIBAgIQGkTSlT8/2bAURo/J1C2/STANBgkqhkiG9w0BAQsFADBC
MQswCQYDVQQGEwJVUzEWMBQGA1UEChMNR2VvVHJ1c3QgSW5jLjEbMBkGA1UEAxMS
UmFwaWRTU0wgU0hBMjU2IENBMB4XDTE2MTExNzAwMDAwMFoXDTE4MTExNzIzNTk1
OVowKjEoMCYGA1UEAwwfaW52YWxpZC1leHBlY3RlZC1zY3QuYmFkc3NsLmNvbTCC
ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMIE7PiM7gTCs9hQ1XBYzJMY
61yoaEmwIrX5lZ6xKyx2PmzAS2BMTOqytMAPgLaw+XLJhgL5XEFdEyt/ccRLvOmU
LlA3pmccYYz2QULFRtMWhyefdOsKnRFSJiFzbIRMeVXk0WvoBj1IFVKtsyjbqv9u
/2CVSndrOfEk0TG23U3AxPxTuW1CrbV8/q71FdIzSOciccfCFHpsKOo3St/qbLVy
tH5aohbcabFXRNsKEqveww9HdFxBIuGa+RuT5q0iBikusbpJHAwnnqP7i/dAcgCs
kgjZjFeEU4EFy+b+a1SYQCeFxxC7c3DvaRhBB0VVfPlkPz0sw6l865MaTIbRyoUC
AwEAAaOCAiAwggIcMCoGA1UdEQQjMCGCH2ludmFsaWQtZXhwZWN0ZWQtc2N0LmJh
ZHNzbC5jb20wCQYDVR0TBAIwADArBgNVHR8EJDAiMCCgHqAchhpodHRwOi8vZ3Au
c3ltY2IuY29tL2dwLmNybDBvBgNVHSAEaDBmMGQGBmeBDAECATBaMCoGCCsGAQUF
BwIBFh5odHRwczovL3d3dy5yYXBpZHNzbC5jb20vbGVnYWwwLAYIKwYBBQUHAgIw
IAweaHR0cHM6Ly93d3cucmFwaWRzc2wuY29tL2xlZ2FsMB8GA1UdIwQYMBaAFJfC
J1CewsnsDIgyyHyt4qYBT9pvMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggr
BgEFBQcDAQYIKwYBBQUHAwIwVwYIKwYBBQUHAQEESzBJMB8GCCsGAQUFBzABhhNo
dHRwOi8vZ3Auc3ltY2QuY29tMCYGCCsGAQUFBzAChhpodHRwOi8vZ3Auc3ltY2Iu
Y29tL2dwLmNydDAPBgMrZU0ECDAGAgEBAgEBMIGKBgorBgEEAdZ5AgQCBHwEegB4
AHYAp85KTmIH4K3e5f2qSx+GdodntdACpV1HMQ5+ZwqV6rIAAAFYb//OtAAABAMA
RzBFAiEAuAOtNPb8Dyz/hKCG5dfPWvAKB2Jqf7OmRGTxlaRIRRECIC9hjVMbb0q4
CmeyB+GPba3RBEpes4nvfGDCaFP5PR9tMA0GCSqGSIb3DQEBCwUAA4IBAQBIMHww
vuW8XOBdxw0Mq0z3NFsAW2XvkcXtTGmB5savCpRJ6LN0ub6NJX+KiFmDo9voMDro
YL7o9i+BrSAFo3hr8QNxLLJaXD54h8lJ0oCkzyZtzezM8p2PWsEjouePtdE0AIHn
RK0SnKBk9w0b3CMSbzObc1Cu8ATqZnE51d7xurim7qTZMhJM2hi9HeLPLVdEBiuC
zmYtNpRMMQqbQvvrXftAohq/W90rK42Ss8kYIf8FsVTa5VaqXW7lIh/3JmBNLZ1D
Aw5rmaztWlYO64YS7z4am5d9h2rrF1rfgv9Mc3caxAUO3sJZDRyhYaj+7BUgv8HR
otJHkjr2ASPp31Yf
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIETTCCAzWgAwIBAgIDAjpxMA0GCSqGSIb3DQEBCwUAMEIxCzAJBgNVBAYTAlVT
MRYwFAYDVQQKEw1HZW9UcnVzdCBJbmMuMRswGQYDVQQDExJHZW9UcnVzdCBHbG9i
YWwgQ0EwHhcNMTMxMjExMjM0NTUxWhcNMjIwNTIwMjM0NTUxWjBCMQswCQYDVQQG
EwJVUzEWMBQGA1UEChMNR2VvVHJ1c3QgSW5jLjEbMBkGA1UEAxMSUmFwaWRTU0wg
U0hBMjU2IENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1jBEgEu
l9h9GKrIwuWF4hdsYC7JjTEFORoGmFbdVNcRjFlbPbFUrkshhTIWX1SG5tmx2GCJ
a1i+ctqgAEJ2sSdZTM3jutRc2aZ/uyt11UZEvexAXFm33Vmf8Wr3BvzWLxmKlRK6
msrVMNI4/Bk7WxU7NtBDTdFlodSLwWBBs9ZwF8w5wJwMoD23ESJOztmpetIqYpyg
C04q18NhWoXdXBC5VD0tA/hJ8LySt7ecMcfpuKqCCwW5Mc0IW7siC/acjopVHHZD
dvDibvDfqCl158ikh4tq8bsIyTYYZe5QQ7hdctUoOeFTPiUs2itP3YqeUFDgb5rE
1RkmiQF1cwmbOwIDAQABo4IBSjCCAUYwHwYDVR0jBBgwFoAUwHqYaI2J+6sFZAwR
fap9ZbjKzE4wHQYDVR0OBBYEFJfCJ1CewsnsDIgyyHyt4qYBT9pvMBIGA1UdEwEB
/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgEGMDYGA1UdHwQvMC0wK6ApoCeGJWh0
dHA6Ly9nMS5zeW1jYi5jb20vY3Jscy9ndGdsb2JhbC5jcmwwLwYIKwYBBQUHAQEE
IzAhMB8GCCsGAQUFBzABhhNodHRwOi8vZzIuc3ltY2IuY29tMEwGA1UdIARFMEMw
QQYKYIZIAYb4RQEHNjAzMDEGCCsGAQUFBwIBFiVodHRwOi8vd3d3Lmdlb3RydXN0
LmNvbS9yZXNvdXJjZXMvY3BzMCkGA1UdEQQiMCCkHjAcMRowGAYDVQQDExFTeW1h
bnRlY1BLSS0xLTU2OTANBgkqhkiG9w0BAQsFAAOCAQEANevhiyBWlLp6vXmp9uP+
bji0MsGj21hWID59xzqxZ2nVeRQb9vrsYPJ5zQoMYIp0TKOTKqDwUX/N6fmS/Zar
RfViPT9gRlATPSATGC6URq7VIf5Dockj/lPEvxrYrDrK3maXI67T30pNcx9vMaJR
BBZqAOv5jUOB8FChH6bKOvMoPF9RrNcKRXdLDlJiG9g4UaCSLT+Qbsh+QJ8gRhVd
4FB84XavXu0R0y8TubglpK9YCa81tGJUheNI3rzSkHp6pIQNo0LyUcDUrVNlXWz4
Px8G8k/Ll6BKWcZ40egDuYVtLLrhX7atKz4lecWLVtXjCYDqwSfC2Q7sRwrp0Mr8
2A==
-----END CERTIFICATE-----`

// 外交部邮件系统更新后的证书
var testCert5 = `-----BEGIN CERTIFICATE-----
MIIGYTCCBUmgAwIBAgIQIBUBlq1kotjEbSfq7HNN3TANBgkqhkiG9w0BAQsFADBV
MQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj
YXRpb24gQXV0aG9yaXR5MRQwEgYDVQQDDAtDRkNBIE9WIE9DQTAeFw0xODA4MDEw
OTE4MjdaFw0yMDA4MDEwOTE4MjdaMHQxCzAJBgNVBAYTAkNOMRAwDgYDVQQIDAdC
ZWlqaW5nMRAwDgYDVQQHDAdCZWlqaW5nMScwJQYDVQQKDB7kuK3ljY7kurrmsJHl
hbHlkozlm73lpJbkuqTpg6gxGDAWBgNVBAMMD21haWwubWZhLmdvdi5jbjCCASIw
DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN6oaQ0r6YoymrSB+CTGVGd3XaUJ
zgtmsOlSoQbaGyqJZ6X1rxDr1StMWrks/WBE3aXMV/tmYBK8bYLgiI34ub5CwsJ4
74pBYia2371SLbr2YPUFFH7kaCu788txzQwXCyXMSJwS1vxxM0KwCjZxzPpnm0pT
orqGO2jjGArVEAJam8k26Bpw2P1R7aprJtxGY269LXRbZLxR2RoPvN0Hg/w/UKvN
w4cipmWtsiB7PYlter/UXX/EcAkBc80CFZG52cdrgZOXftUix201npikk+ibrJ98
ePU7UEuA9nOMfZZWNbsrGAq3X+MnmNXxtDjlH7b2cNSprVhSVDljmcGbzfsCAwEA
AaOCAwwwggMIMAkGA1UdEwQCMAAwbAYIKwYBBQUHAQEEYDBeMCgGCCsGAQUFBzAB
hhxodHRwOi8vb2NzcC5jZmNhLmNvbS5jbi9vY3NwMDIGCCsGAQUFBzAChiZodHRw
Oi8vZ3RjLmNmY2EuY29tLmNuL292b2NhL292b2NhLmNlcjAaBgNVHREEEzARgg9t
YWlsLm1mYS5nb3YuY24wCwYDVR0PBAQDAgWgMB0GA1UdDgQWBBTassDnJlFr43Lv
yJLQZtedNYNC4DAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwggF+Bgor
BgEEAdZ5AgQCBIIBbgSCAWoBaAB1AO5Lvbd1zmC64UJpH6vhnmajD35fsHLYgwDE
e4l6qP3LAAABZPTIEw0AAAQDAEYwRAIgOCpWwzCPQ+JhHRDAIpjMefuTvHtYeg8c
/EaPm/1Gwj4CIFHoRmQOqKAaRQ1sNbiAJad4clH2ibETmtL8gDmHCSVuAHYApLkJ
kLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFk9Mgc1AAABAMARzBFAiAS
0RLJHV+Kh4Q79njcYlug300CCC5lXVXnqD6d/7SekwIhANWwqH2dxjBziM0OXitX
SAcyq8oRxtgat6HaWtAsXzalAHcAb1N2rDHwMRnYmQCkURX/dxUcEdkCwQApBo2y
CJo32RMAAAFk9MgmiwAABAMASDBGAiEA6glQLdLb6mxn697vKr6bG2YhQr92l94v
QqTNL81Dd1sCIQCwGJOxcx1yKqLz9887DrEsfCQiVJ7eHT5ezMNnsmwizjAfBgNV
HSMEGDAWgBRms+/7VJWH6aylllau5n3tOtBD0TBGBgNVHSAEPzA9MDsGBmeBDAEC
AjAxMC8GCCsGAQUFBwIBFiNodHRwOi8vd3d3LmNmY2EuY29tLmNuL3VzL3VzLTEy
Lmh0bTA7BgNVHR8ENDAyMDCgLqAshipodHRwOi8vY3JsLmNmY2EuY29tLmNuL09W
T0NBL1JTQS9jcmwyNC5jcmwwDQYJKoZIhvcNAQELBQADggEBACA68jq5yuoxl+ng
MTvsqAxmZ1GIr4YKSPuJ0I4DhbJZWs4EqZN7E7PPRvFtNE1A8qkFD8Qhcbgo9Jwc
d7QXi+zhyqfHlk5Y3Y24I+bj286w6xfN+hL1WY71FBEI2ubsZy5pyJe8fG7cHzGo
C+y3qNoDTMmrq92bmGZ/9xIBJjz9jCDg74WOZrQFNELJU2FCUYZqFTD2ygM93GBK
Ru1eI3JXfdkPLgSrexdDBn1ACYXWx35BCRTcIrGUXEFMv1KXZcCOrVzaSaXk/U05
dul5qkJ1AK5k575vdL/ibTozOjOZMQqIEzmHTSPzGZaFTVdvV3aEH6t7xKYWBeHW
3s9dt4E=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFfDCCA2SgAwIBAgILAPnfat/1ZL6mi4IwDQYJKoZIhvcNAQELBQAwVjELMAkG
A1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9u
IEF1dGhvcml0eTEVMBMGA1UEAwwMQ0ZDQSBFViBST09UMB4XDTE1MDMyNTAyMDI1
NloXDTI5MTIyNTAyMDI1NlowVTELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5h
IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEUMBIGA1UEAwwLQ0ZD
QSBPViBPQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDn14xTy0bH
zkaeyACeq6ryfxxG5zZT1fCL4lmw7sk6SVmOKNfE60Gf7W6orksrFVIbIMK+VrYp
+aYyhScq8EJT9xXBgXK2HqtpaDGOeclspJvcs+rXn9tlT789NBp3i5U+nLE9M1bR
CHSx3Hzu8p7Aeqllou+8nZ2egaVbWFL1zC1JENupSSI9Yjbefhb06y/TVxQ0x4Zt
zwPwLcd8NUtSruldolxPbhQeCZNJMPq1GKMxhd5pDwY4mCKxDeraqhTNXui9Aef3
qyi2Ic9EXmdNPARkZJU2XTJ9FJ+DE+ChaIvfJ/VwQfM0eGlBn/SAaav54jBmRnec
PeD6YfpuiJ8vAgMBAAGjggFKMIIBRjA4BggrBgEFBQcBAQQsMCowKAYIKwYBBQUH
MAGGHGh0dHA6Ly9vY3NwLmNmY2EuY29tLmNuL29jc3AwHwYDVR0jBBgwFoAU4/4t
/SjQC7W6tqLEvwaqBYyT+y8wDwYDVR0TAQH/BAUwAwEB/zBEBgNVHSAEPTA7MDkG
BFUdIAAwMTAvBggrBgEFBQcCARYjaHR0cDovL3d3dy5jZmNhLmNvbS5jbi91cy91
cy0xMi5odG0wOgYDVR0fBDMwMTAvoC2gK4YpaHR0cDovL2NybC5jZmNhLmNvbS5j
bi9ldnJjYS9SU0EvY3JsMS5jcmwwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBRm
s+/7VJWH6aylllau5n3tOtBD0TAnBgNVHSUEIDAeBggrBgEFBQcDAgYIKwYBBQUH
AwQGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4ICAQDKER8qcBmZGOG8GOJ670VW
OSg3UovOoc7/xz2mE+enyEcSwn/0QrL8C5DSA6nMvBMrCWEytYPofGQUXTwtlu78
GLxYNn3A/RtzczJ+/BXIhoe3aOT4tQ+2s9vrFRfIXs4CkmqHhfYSvArokdayYmBd
78psIwS5LCUzGKSn7y8UmAgoxiy7RtrVt5c1wvJyeuYk1Z1l8MN1szPrmAb4HS/D
qnB+0qdhFGvfOyv7lg6/wlIAkN84cHlKNC3JvyFHaCIAyhTPgjUayUvBKFK7XwN9
utIXl2L3IZX7zfxGS/J9+ZeNwyblQKmd/MKydJu9Ak6+ZMLLgjlCFkihJIn9Ur8M
2KQigz7YPDVIJjOtS7ljOQVGh88LPUnQ1fBY7RwagficS/xclIOnaXhoyWzg7EcQ
/T1/O4FkpMqKuOreaI5NExjAT8cKizyY2wcOOXKIYri3Ewnbm+00IaYYaiQRGUR6
pzFFKxdFMbStCtI4ObN+A9tB7cnBCW4vz3sAJd/OgmLF38XTa+/km3c1nQOfhCGs
6kx2heN/DgFAc+P7ldObo/kgGQtR6tr02gyXCFWnLMtT0+CoNOY0o3T+LbEqYeKL
W7p29G9sgHgoqLFibWNMSKG1QvevkhjUMOD/g48f/nMSYsbU++yEaLvjvRHbb5ON
IPkcE28TRhQQKmDKI+DRIg==
-----END CERTIFICATE-----`

// 外交部邮件系统更新前的证书
var testCert4 = `-----BEGIN CERTIFICATE-----
MIIF9zCCBN+gAwIBAgIQIBUB29g/iLyLyCn2ndm51jANBgkqhkiG9w0BAQsFADBV
MQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj
YXRpb24gQXV0aG9yaXR5MRQwEgYDVQQDDAtDRkNBIE9WIE9DQTAeFw0xODA1Mjgw
OTI2MTlaFw0yMDA1MjgwOTI2MTlaMIGDMQswCQYDVQQGEwJDTjEPMA0GA1UECAwG
5YyX5LqsMQ8wDQYDVQQHDAbljJfkuqwxJzAlBgNVBAoMHuS4reWNjuS6uuawkeWF
seWSjOWbveWkluS6pOmDqDEPMA0GA1UECwwG5LiA5bGAMRgwFgYDVQQDDA9tYWls
Lm1mYS5nb3YuY24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJQdNJ
IzWAVUmV48PhAgBwFKIiCuSJg7bJRDsIcMRCecn7Z6NlbZegvqBsAEN8odd+6EgC
8fa6PBhNFJ25pL5MUzkshywkdT9sBgj20lqVHPWTAu6KmedOMylrP2LeQdR5Vn3y
TvVMjH4YZjsDn2ntLSTJRX1p5S4M8mU6inNWMw+nupKLy9Rpm6T/iYWblYo4KHzr
Hk5J2r1RV3xJPCZID5bu8NNnQAKd0XButE+Bdbfd3EojqYUrJ9kKyOjVegKQODkp
40HNw9Bs/AMYB3V5eD1rkdqePm8ZkDkGFZO/EznVtpj6IKSExQBkWJgsonSWJEZw
tV+nJHrzO2PAXBeLAgMBAAGjggKSMIICjjAJBgNVHRMEAjAAMGwGCCsGAQUFBwEB
BGAwXjAoBggrBgEFBQcwAYYcaHR0cDovL29jc3AuY2ZjYS5jb20uY24vb2NzcDAy
BggrBgEFBQcwAoYmaHR0cDovL2d0Yy5jZmNhLmNvbS5jbi9vdm9jYS9vdm9jYS5j
ZXIwGgYDVR0RBBMwEYIPbWFpbC5tZmEuZ292LmNuMAsGA1UdDwQEAwIFoDAdBgNV
HQ4EFgQUNnP1gALyUxXhAjwr8XMYSf52CHgwHQYDVR0lBBYwFAYIKwYBBQUHAwIG
CCsGAQUFBwMBMIIBBAYKKwYBBAHWeQIEAgSB9QSB8gDwAHYA7ku9t3XOYLrhQmkf
q+GeZqMPfl+wctiDAMR7iXqo/csAAAFjphHrJwAABAMARzBFAiByLwKrJBeMNrbl
LGduW2iwXHv4nIMbVeNzZMp9A9XLyQIhAKuo4tQGdClo5GN+W+L+gtT1mwhGE7hN
rMq2OzeOwu6WAHYAb1N2rDHwMRnYmQCkURX/dxUcEdkCwQApBo2yCJo32RMAAAFj
phHzngAABAMARzBFAiBlCAUtwelcHap1K169s6jSShljzQ9iKO7XjQsrpNqyuAIh
AOznvTU0Ka4Cn/sEH74xgJPQ8O5uYSd3lscchnklerGnMB8GA1UdIwQYMBaAFGaz
7/tUlYfprKWWVq7mfe060EPRMEYGA1UdIAQ/MD0wOwYGZ4EMAQICMDEwLwYIKwYB
BQUHAgEWI2h0dHA6Ly93d3cuY2ZjYS5jb20uY24vdXMvdXMtMTIuaHRtMDsGA1Ud
HwQ0MDIwMKAuoCyGKmh0dHA6Ly9jcmwuY2ZjYS5jb20uY24vT1ZPQ0EvUlNBL2Ny
bDI0LmNybDANBgkqhkiG9w0BAQsFAAOCAQEAI28jN4VRJCrSiYBocUXp2RWU+rJE
wlErQkT86j7E9VGJl2fJV8G5dIJK/eJY17hm3EKgFtBYZuQweCyYayPEHWLan0ey
1iyW62oOdfUqpYa3cp1XG6M+rp6BKBym+QMLwfG+uYwdHUnLCwlMfvSCFFfkSwli
T5W1oDkoVPuQilFtDl0Yy/G7hy5DmG+j1pjbYKyWJPvJaRiQOd35XlH9z34VUlc4
nci+81sp5ift6HiObblZk2HNBfpu/HkLuOL7bI0wBz/gBQUzUln/8YNM36DCF5zi
EyG+kENgPfCg2syDEeXuzkAYnP/sc9zcYECWYlcN4Fsi+0g7KQJj7QRF8A==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFfDCCA2SgAwIBAgILAPnfat/1ZL6mi4IwDQYJKoZIhvcNAQELBQAwVjELMAkG
A1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9u
IEF1dGhvcml0eTEVMBMGA1UEAwwMQ0ZDQSBFViBST09UMB4XDTE1MDMyNTAyMDI1
NloXDTI5MTIyNTAyMDI1NlowVTELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5h
IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEUMBIGA1UEAwwLQ0ZD
QSBPViBPQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDn14xTy0bH
zkaeyACeq6ryfxxG5zZT1fCL4lmw7sk6SVmOKNfE60Gf7W6orksrFVIbIMK+VrYp
+aYyhScq8EJT9xXBgXK2HqtpaDGOeclspJvcs+rXn9tlT789NBp3i5U+nLE9M1bR
CHSx3Hzu8p7Aeqllou+8nZ2egaVbWFL1zC1JENupSSI9Yjbefhb06y/TVxQ0x4Zt
zwPwLcd8NUtSruldolxPbhQeCZNJMPq1GKMxhd5pDwY4mCKxDeraqhTNXui9Aef3
qyi2Ic9EXmdNPARkZJU2XTJ9FJ+DE+ChaIvfJ/VwQfM0eGlBn/SAaav54jBmRnec
PeD6YfpuiJ8vAgMBAAGjggFKMIIBRjA4BggrBgEFBQcBAQQsMCowKAYIKwYBBQUH
MAGGHGh0dHA6Ly9vY3NwLmNmY2EuY29tLmNuL29jc3AwHwYDVR0jBBgwFoAU4/4t
/SjQC7W6tqLEvwaqBYyT+y8wDwYDVR0TAQH/BAUwAwEB/zBEBgNVHSAEPTA7MDkG
BFUdIAAwMTAvBggrBgEFBQcCARYjaHR0cDovL3d3dy5jZmNhLmNvbS5jbi91cy91
cy0xMi5odG0wOgYDVR0fBDMwMTAvoC2gK4YpaHR0cDovL2NybC5jZmNhLmNvbS5j
bi9ldnJjYS9SU0EvY3JsMS5jcmwwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBRm
s+/7VJWH6aylllau5n3tOtBD0TAnBgNVHSUEIDAeBggrBgEFBQcDAgYIKwYBBQUH
AwQGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4ICAQDKER8qcBmZGOG8GOJ670VW
OSg3UovOoc7/xz2mE+enyEcSwn/0QrL8C5DSA6nMvBMrCWEytYPofGQUXTwtlu78
GLxYNn3A/RtzczJ+/BXIhoe3aOT4tQ+2s9vrFRfIXs4CkmqHhfYSvArokdayYmBd
78psIwS5LCUzGKSn7y8UmAgoxiy7RtrVt5c1wvJyeuYk1Z1l8MN1szPrmAb4HS/D
qnB+0qdhFGvfOyv7lg6/wlIAkN84cHlKNC3JvyFHaCIAyhTPgjUayUvBKFK7XwN9
utIXl2L3IZX7zfxGS/J9+ZeNwyblQKmd/MKydJu9Ak6+ZMLLgjlCFkihJIn9Ur8M
2KQigz7YPDVIJjOtS7ljOQVGh88LPUnQ1fBY7RwagficS/xclIOnaXhoyWzg7EcQ
/T1/O4FkpMqKuOreaI5NExjAT8cKizyY2wcOOXKIYri3Ewnbm+00IaYYaiQRGUR6
pzFFKxdFMbStCtI4ObN+A9tB7cnBCW4vz3sAJd/OgmLF38XTa+/km3c1nQOfhCGs
6kx2heN/DgFAc+P7ldObo/kgGQtR6tr02gyXCFWnLMtT0+CoNOY0o3T+LbEqYeKL
W7p29G9sgHgoqLFibWNMSKG1QvevkhjUMOD/g48f/nMSYsbU++yEaLvjvRHbb5ON
IPkcE28TRhQQKmDKI+DRIg==
-----END CERTIFICATE-----`

// 新发的两年，已经包含3个SCT
var testCert3 = `-----BEGIN CERTIFICATE-----
MIIGjjCCBXagAwIBAgIQDXCc+PSRSbMpc2nTICg6lTANBgkqhkiG9w0BAQsFADBY
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMRcwFQYDVQQDEw5TZWN1cmUgU2l0ZSBDQTAeFw0xODA3
MjUwMDAwMDBaFw0yMDA3MjQxMjAwMDBaMIGFMQswCQYDVQQGEwJDTjEPMA0GA1UE
CAwG5LqR5Y2XMQ8wDQYDVQQHDAbmmIbmmI4xJzAlBgNVBAoMHuS6keWNl+W7uuaK
leeJqea1geaciemZkOWFrOWPuDEYMBYGA1UECwwP55S15ZWG5LqL5Lia6YOoMREw
DwYDVQQDEwhpbmphLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
AMtfJJOSSiOZxS3xVrthqWmqq2vmvF1XpjURtbvFxWkAHDfLv5j46JM08Wmh26cn
oioInbUjXw2w0RX2yjfFC1rwlhQVnkUBjYhS5xwnoOfizq382xgcqHaJ6T+MZzfG
0GTqKHNNYwZrOR1Wthomzvh5TxGUgH8Q1ZJ+SaBwawN9gSvRNj56pHOF4wqBPXL8
r22QhH2Byaif8xbK+nBRBr+Z5+uh5v63U6znt82KM1cOUNmwJYgEGsZLbw2ZwWQd
3OWqLcbWl/aTkcW4sO4X2O/pcKtFJay34QwY96hU0xWG2k7P5aQ/1Va/Oj86mrnm
RnebtF5YKXQszL/+lIspITcCAwEAAaOCAyQwggMgMB8GA1UdIwQYMBaAFMQRfohA
hsJBv2XzGuG0U0Cjq+x9MB0GA1UdDgQWBBQUsxpcsucpzqo//SY2mNH+ZjdwVTAh
BgNVHREEGjAYgghpbmphLmNvbYIMd3d3LmluamEuY29tMA4GA1UdDwEB/wQEAwIF
oDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwPAYDVR0fBDUwMzAxoC+g
LYYraHR0cDovL2NkcDEuZGlnaWNlcnQuY29tL1NlY3VyZVNpdGVDQS0xLmNybDBM
BgNVHSAERTBDMDcGCWCGSAGG/WwBATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3
dy5kaWdpY2VydC5jb20vQ1BTMAgGBmeBDAECAjByBggrBgEFBQcBAQRmMGQwJQYI
KwYBBQUHMAGGGWh0dHA6Ly9vY3NwMS5kaWdpY2VydC5jb20wOwYIKwYBBQUHMAKG
L2h0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LWNuLmNvbS9TZWN1cmVTaXRlQ0EuY3J0
MAkGA1UdEwQCMAAwggF/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB3AO5Lvbd1zmC6
4UJpH6vhnmajD35fsHLYgwDEe4l6qP3LAAABZM/goYAAAAQDAEgwRgIhAM7PtCxp
lVrCCxwlqkAuqKymSoJKuCsdH6r2sbyY+V3MAiEAgn6Up6t2yDCf0mCv6DUTHJVZ
VbgiS2uDUVjStH601XgAdgCHdb/nWXz4jEOZX73zbv9WjUdWNv9KtWDBtOr/XqCD
DwAAAWTP4KH9AAAEAwBHMEUCIH5eTi48XJch9ebl+QcMZ66qcMhmv06UfFQmShWF
6z0iAiEA1ZWQWUIDim0/3JePYpvR4vWX948b3Ua6Dc9GlwSzNz8AdgC72d+8H4px
tZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAAAWTP4KJMAAAEAwBHMEUCIGejCHCd
VqFnGXsHXxR3+VayvgIX3MFaCSNjBq0/FRF1AiEAtVL0/t/8VIe9AtXy+rAipJHi
K9bjLl9PGOuZCNQsvbEwDQYJKoZIhvcNAQELBQADggEBADvr3BbjQPRmJAieVlfb
ZcZ2cB6UnudOw0CTMesVshO/YVDrli+rFLWr8ok4SCJEWMMA0zWibyp/f/TYM3aK
bXscf7xKxbur/BqBG9zn/dlGbSzGd6wq/QjhT0ZRk/7+sP3i4RD5b+LH/1G51ubi
zm3O5ehekj0CorztVrXM4URuDujOeSxDOJOVukFuezTlU6fediazDkWZu2OU8uSj
plPcl61HyhpvKGKVmmIA5XafbcqcUCY+dVb5DVuEjt4MiHcEE3aG8DGk9jG+EN+O
jabFgcv2NvQj130IlAqEItm/DBw+KEzx1MTi0Wj/wkITTlFl5TUn6Xu9BXlnzDPZ
yD0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEozCCA4ugAwIBAgIQBdH8WS5y3RzQI80YGNqnHzANBgkqhkiG9w0BAQsFADBh
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD
QTAeFw0xODA1MTcxMjMwMTNaFw0zMDA1MTcxMjMwMTNaMFgxCzAJBgNVBAYTAlVT
MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5j
b20xFzAVBgNVBAMTDlNlY3VyZSBTaXRlIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAx7s903fR6SgpA08UdhKEUIZHa2Ig7KPNkTtwMS1+08YS5QSE
DM4DQxy48jP8dZkyyU9J/0WCm8Nlv5ga7HOAxhdJcv+CPP4oadx8EbdrmjAHrGOv
64oHvt7Ina7uzLd3krqxd0doeuxRpTHvFAyjaUhxjSfZx0wh1f6W7prPm7V50VcT
udj4rI+xtHXUcFAuFz4bcapTcru5aaZ1v6F2usMCMVM+xJxEZcsUM4uTxdIfW5FU
TI0dbP8NyZkr/WVzL59aGwBE4ZU0JKBlgEmtkFpLPR7JCzYunafu7nMk5YY26WDO
mezpWDjzDxJ8xakizykWYT5gdJYE3ULlUe31WQIDAQABo4IBXjCCAVowHQYDVR0O
BBYEFMQRfohAhsJBv2XzGuG0U0Cjq+x9MB8GA1UdIwQYMBaAFAPeUDVW0Uy7ZvCj
4hsbw5eyPdFVMA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYI
KwYBBQUHAwIwEgYDVR0TAQH/BAgwBgEB/wIBADA3BggrBgEFBQcBAQQrMCkwJwYI
KwYBBQUHMAGGG2h0dHA6Ly9vY3NwLmRpZ2ljZXJ0LWNuLmNvbTBEBgNVHR8EPTA7
MDmgN6A1hjNodHRwOi8vY3JsLmRpZ2ljZXJ0LWNuLmNvbS9EaWdpQ2VydEdsb2Jh
bFJvb3RDQS5jcmwwVgYDVR0gBE8wTTA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcC
ARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwCAYGZ4EM
AQIDMA0GCSqGSIb3DQEBCwUAA4IBAQDIiGcy9AiAa0e41RwQxUUs9uukRK8H5ekg
gREh38fJ4vAjYliu6t5VjNSI4+yzXVw0sy8JmaHzOs5A7AqqOsovIwJxP5/MMAh7
U/K9QWeD5mqRpWUi9vluwqQPEtK4tgZt1s99RezAUK8Jtjfn5UmUxUh6ET4lxyDe
0NhgxpfsWsgeYgwYEGrODa6fHQTpmxGTzyNvjUIR4de09NfRoCUWUumjNMLdaLqf
Vv6kRihaDDZc2bjoANtTUJ2lyHZJqo0mAVs6gZJ4Jl7SgtdxfnkxHuzDrjWxwo98
VueqqRBUewSmweO+btngjVd6Gj3E99EGIJq3k9k4HXPUaRJLQ3qY
-----END CERTIFICATE-----`

// 2018年4月30号前发的2年，没有CT信息也不受影响
var testCert2 = `-----BEGIN CERTIFICATE-----
MIIFAjCCA+qgAwIBAgIQIBUBm2VnrFtcX6Nsc76jazANBgkqhkiG9w0BAQsFADBV
MQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj
YXRpb24gQXV0aG9yaXR5MRQwEgYDVQQDDAtDRkNBIE9WIE9DQTAeFw0xNzA3MDYw
NzI4NDZaFw0xOTA3MDYwNzI4NDZaMIGSMQswCQYDVQQGEwJDTjESMBAGA1UECAwJ
5YyX5Lqs5biCMRIwEAYDVQQHDAnljJfkuqzluIIxMDAuBgNVBAoMJ+WMl+S6rOWY
ieWNjumTreWTgeeJjOetluWIkuaciemZkOWFrOWPuDELMAkGA1UECwwCSVQxHDAa
BgNVBAMME29wZW4uamlhaHVhbWluZy5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IB
DwAwggEKAoIBAQDD5c/uBYhSDvsm18K8Q13pWPS7QJVHX6UA1Fz/qrEE6d44Wxo/
0U2/FqDv6SjuVlLzs7BzHPMUBfYSUjRHBb3BtUQg6WG1AecqugK4S/QnF3sO7oev
5VS2brDSi2tDpMX8Ev1uhYEgaRF+PTeW6t8GQzTJVm/OFJYglshYpnZVqwM7U4nt
PFk8BeGxTv+HIBQXqixDR41mkLK2QCETmmDHDia7gRRAbGNa7Ls22Sx7Ojf3yC2r
MZjzaiB51nHzfB9+oNybSgSHRivuhQ4Hq2ybCkY7PKpFr7e8xZ33X4okluSsyndB
U3Nepv9v7V+x57HbTBvS9u6y0G0eyYHu+gOZAgMBAAGjggGOMIIBijAJBgNVHRME
AjAAMGwGCCsGAQUFBwEBBGAwXjAoBggrBgEFBQcwAYYcaHR0cDovL29jc3AuY2Zj
YS5jb20uY24vb2NzcDAyBggrBgEFBQcwAoYmaHR0cDovL2d0Yy5jZmNhLmNvbS5j
bi9vdm9jYS9vdm9jYS5jZXIwHgYDVR0RBBcwFYITb3Blbi5qaWFodWFtaW5nLmNv
bTALBgNVHQ8EBAMCBaAwHQYDVR0OBBYEFK4ylZnNsTS5hrEmx1dAmrH4AlE1MB0G
A1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATAfBgNVHSMEGDAWgBRms+/7VJWH
6aylllau5n3tOtBD0TBGBgNVHSAEPzA9MDsGBmeBDAECAjAxMC8GCCsGAQUFBwIB
FiNodHRwOi8vd3d3LmNmY2EuY29tLmNuL3VzL3VzLTEyLmh0bTA7BgNVHR8ENDAy
MDCgLqAshipodHRwOi8vY3JsLmNmY2EuY29tLmNuL09WT0NBL1JTQS9jcmwyMy5j
cmwwDQYJKoZIhvcNAQELBQADggEBAOYsb3Ee1GPEG0piKD3LzM/WXMw3RF2P4yqs
qbDJ67MFfvwVLP0131YIpf7rtEtoCcypVoAIV445iz8pVvQ5MqbyAyA7v98l7JkY
KkJ6PcYt3diH0w5lUv1RFycFupFiP4y4KgKFKZRFPxQcib1+H1Sxz1jr/WLlEEYK
CFMC54ZDpex92osmkhiQUQiNLBJS8d+vosAXmlYNzK7cEr+tcLKFwtyUaVhWsrgG
XdwKKo1d8cpa740RlBIBRaWPsjrKN8ztiJohx94NQyfzh4VJ4WKe7YESi0RWgKgD
07o5EwG//W7Dw7TJVazq1JF/49SBGqqLEkCrGMsB3hA9PA9WjK4=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFfDCCA2SgAwIBAgILAPnfat/1ZL6mi4IwDQYJKoZIhvcNAQELBQAwVjELMAkG
A1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9u
IEF1dGhvcml0eTEVMBMGA1UEAwwMQ0ZDQSBFViBST09UMB4XDTE1MDMyNTAyMDI1
NloXDTI5MTIyNTAyMDI1NlowVTELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5h
IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEUMBIGA1UEAwwLQ0ZD
QSBPViBPQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDn14xTy0bH
zkaeyACeq6ryfxxG5zZT1fCL4lmw7sk6SVmOKNfE60Gf7W6orksrFVIbIMK+VrYp
+aYyhScq8EJT9xXBgXK2HqtpaDGOeclspJvcs+rXn9tlT789NBp3i5U+nLE9M1bR
CHSx3Hzu8p7Aeqllou+8nZ2egaVbWFL1zC1JENupSSI9Yjbefhb06y/TVxQ0x4Zt
zwPwLcd8NUtSruldolxPbhQeCZNJMPq1GKMxhd5pDwY4mCKxDeraqhTNXui9Aef3
qyi2Ic9EXmdNPARkZJU2XTJ9FJ+DE+ChaIvfJ/VwQfM0eGlBn/SAaav54jBmRnec
PeD6YfpuiJ8vAgMBAAGjggFKMIIBRjA4BggrBgEFBQcBAQQsMCowKAYIKwYBBQUH
MAGGHGh0dHA6Ly9vY3NwLmNmY2EuY29tLmNuL29jc3AwHwYDVR0jBBgwFoAU4/4t
/SjQC7W6tqLEvwaqBYyT+y8wDwYDVR0TAQH/BAUwAwEB/zBEBgNVHSAEPTA7MDkG
BFUdIAAwMTAvBggrBgEFBQcCARYjaHR0cDovL3d3dy5jZmNhLmNvbS5jbi91cy91
cy0xMi5odG0wOgYDVR0fBDMwMTAvoC2gK4YpaHR0cDovL2NybC5jZmNhLmNvbS5j
bi9ldnJjYS9SU0EvY3JsMS5jcmwwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBRm
s+/7VJWH6aylllau5n3tOtBD0TAnBgNVHSUEIDAeBggrBgEFBQcDAgYIKwYBBQUH
AwQGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4ICAQDKER8qcBmZGOG8GOJ670VW
OSg3UovOoc7/xz2mE+enyEcSwn/0QrL8C5DSA6nMvBMrCWEytYPofGQUXTwtlu78
GLxYNn3A/RtzczJ+/BXIhoe3aOT4tQ+2s9vrFRfIXs4CkmqHhfYSvArokdayYmBd
78psIwS5LCUzGKSn7y8UmAgoxiy7RtrVt5c1wvJyeuYk1Z1l8MN1szPrmAb4HS/D
qnB+0qdhFGvfOyv7lg6/wlIAkN84cHlKNC3JvyFHaCIAyhTPgjUayUvBKFK7XwN9
utIXl2L3IZX7zfxGS/J9+ZeNwyblQKmd/MKydJu9Ak6+ZMLLgjlCFkihJIn9Ur8M
2KQigz7YPDVIJjOtS7ljOQVGh88LPUnQ1fBY7RwagficS/xclIOnaXhoyWzg7EcQ
/T1/O4FkpMqKuOreaI5NExjAT8cKizyY2wcOOXKIYri3Ewnbm+00IaYYaiQRGUR6
pzFFKxdFMbStCtI4ObN+A9tB7cnBCW4vz3sAJd/OgmLF38XTa+/km3c1nQOfhCGs
6kx2heN/DgFAc+P7ldObo/kgGQtR6tr02gyXCFWnLMtT0+CoNOY0o3T+LbEqYeKL
W7p29G9sgHgoqLFibWNMSKG1QvevkhjUMOD/g48f/nMSYsbU++yEaLvjvRHbb5ON
IPkcE28TRhQQKmDKI+DRIg==
-----END CERTIFICATE-----`
