{"remainingRequest":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/src/views/main.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/src/views/main.vue","mtime":1656337398240},{"path":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yonghuizhu/Documents/project/SN/vue/renren-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNYWluTmF2YmFyIGZyb20gJy4vbWFpbi1uYXZiYXInCmltcG9ydCBNYWluU2lkZWJhciBmcm9tICcuL21haW4tc2lkZWJhcicKaW1wb3J0IE1haW5Db250ZW50IGZyb20gJy4vbWFpbi1jb250ZW50JwppbXBvcnQgZGVib3VuY2UgZnJvbSAnbG9kYXNoL2RlYm91bmNlJwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvdmlkZSAoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDliLfmlrAKICAgICAgcmVmcmVzaCAoKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuY29udGVudElzTmVlZFJlZnJlc2ggPSB0cnVlCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuY29udGVudElzTmVlZFJlZnJlc2ggPSBmYWxzZQogICAgICAgIH0pCiAgICAgIH0KICAgIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgTWFpbk5hdmJhciwKICAgIE1haW5TaWRlYmFyLAogICAgTWFpbkNvbnRlbnQKICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGU6ICdyb3V0ZUhhbmRsZScKICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy53aW5kb3dSZXNpemVIYW5kbGUoKQogICAgdGhpcy5yb3V0ZUhhbmRsZSh0aGlzLiRyb3V0ZSkKICAgIFByb21pc2UuYWxsKFsKICAgICAgdGhpcy5nZXRVc2VySW5mbygpLAogICAgICB0aGlzLmdldFBlcm1pc3Npb25zKCkKICAgIF0pLnRoZW4oKCkgPT4gewogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOeql+WPo+aUueWPmOWkp+WwjwogICAgd2luZG93UmVzaXplSGFuZGxlICgpIHsKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuc2lkZWJhckZvbGQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbJ2NsaWVudFdpZHRoJ10gPD0gOTkyIHx8IGZhbHNlCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBkZWJvdW5jZSgoKSA9PiB7CiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuc2lkZWJhckZvbGQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbJ2NsaWVudFdpZHRoJ10gPD0gOTkyIHx8IGZhbHNlCiAgICAgIH0sIDE1MCkpCiAgICB9LAogICAgLy8g6Lev55SxLCDnm5HlkKwKICAgIHJvdXRlSGFuZGxlIChyb3V0ZSkgewogICAgICBpZiAoIXJvdXRlLm1ldGEuaXNUYWIpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgICB2YXIgdGFiID0gdGhpcy4kc3RvcmUuc3RhdGUuY29udGVudFRhYnMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lID09PSByb3V0ZS5uYW1lKVswXQogICAgICBpZiAoIXRhYikgewogICAgICAgIHRhYiA9IHsKICAgICAgICAgIC4uLndpbmRvdy5TSVRFX0NPTkZJR1snY29udGVudFRhYkRlZmF1bHQnXSwKICAgICAgICAgIC4uLnJvdXRlLm1ldGEsCiAgICAgICAgICAnbmFtZSc6IHJvdXRlLm5hbWUsCiAgICAgICAgICAncGFyYW1zJzogeyAuLi5yb3V0ZS5wYXJhbXMgfSwKICAgICAgICAgICdxdWVyeSc6IHsgLi4ucm91dGUucXVlcnkgfQogICAgICAgIH0KICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5jb250ZW50VGFicyA9IHRoaXMuJHN0b3JlLnN0YXRlLmNvbnRlbnRUYWJzLmNvbmNhdCh0YWIpCiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuc2lkZWJhck1lbnVBY3RpdmVOYW1lID0gdGFiLm1lbnVJZAogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5jb250ZW50VGFic0FjdGl2ZU5hbWUgPSB0YWIubmFtZQogICAgfSwKICAgIC8vIOiOt+WPluW9k+WJjeeuoeeQhuWRmOS/oeaBrwogICAgZ2V0VXNlckluZm8gKCkgewogICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoJy9zeXMvdXNlci9pbmZvJykudGhlbigoeyBkYXRhOiByZXMgfSkgPT4gewogICAgICAgIGlmIChyZXMuY29kZSAhPT0gMCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykKICAgICAgICB9CiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUudXNlci5pZCA9IHJlcy5kYXRhLmlkCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUudXNlci5uYW1lID0gcmVzLmRhdGEudXNlcm5hbWUKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnN1cGVyQWRtaW4gPSByZXMuZGF0YS5zdXBlckFkbWluCiAgICAgIH0pLmNhdGNoKCgpID0+IHt9KQogICAgfSwKICAgIC8vIOiOt+WPluadg+mZkAogICAgZ2V0UGVybWlzc2lvbnMgKCkgewogICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoJy9zeXMvbWVudS9wZXJtaXNzaW9ucycpLnRoZW4oKHsgZGF0YTogcmVzIH0pID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgIT09IDApIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgfQogICAgICAgIHdpbmRvdy5TSVRFX0NPTkZJR1sncGVybWlzc2lvbnMnXSA9IHJlcy5kYXRhCiAgICAgIH0pLmNhdGNoKCgpID0+IHt9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["main.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div v-loading.fullscreen.lock=\"loading\" :element-loading-text=\"$t('loading')\" :class=\"['aui-wrapper', { 'aui-sidebar--fold': $store.state.sidebarFold }]\">\n    <template v-if=\"!loading\">\n      <main-navbar />\n      <main-sidebar />\n      <div class=\"aui-content__wrapper\">\n        <main-content v-if=\"!$store.state.contentIsNeedRefresh\" />\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport MainNavbar from './main-navbar'\nimport MainSidebar from './main-sidebar'\nimport MainContent from './main-content'\nimport debounce from 'lodash/debounce'\nexport default {\n  provide () {\n    return {\n      // 刷新\n      refresh () {\n        this.$store.state.contentIsNeedRefresh = true\n        this.$nextTick(() => {\n          this.$store.state.contentIsNeedRefresh = false\n        })\n      }\n    }\n  },\n  data () {\n    return {\n      loading: true\n    }\n  },\n  components: {\n    MainNavbar,\n    MainSidebar,\n    MainContent\n  },\n  watch: {\n    $route: 'routeHandle'\n  },\n  created () {\n    this.windowResizeHandle()\n    this.routeHandle(this.$route)\n    Promise.all([\n      this.getUserInfo(),\n      this.getPermissions()\n    ]).then(() => {\n      this.loading = false\n    })\n  },\n  methods: {\n    // 窗口改变大小\n    windowResizeHandle () {\n      this.$store.state.sidebarFold = document.documentElement['clientWidth'] <= 992 || false\n      window.addEventListener('resize', debounce(() => {\n        this.$store.state.sidebarFold = document.documentElement['clientWidth'] <= 992 || false\n      }, 150))\n    },\n    // 路由, 监听\n    routeHandle (route) {\n      if (!route.meta.isTab) {\n        return false\n      }\n      var tab = this.$store.state.contentTabs.filter(item => item.name === route.name)[0]\n      if (!tab) {\n        tab = {\n          ...window.SITE_CONFIG['contentTabDefault'],\n          ...route.meta,\n          'name': route.name,\n          'params': { ...route.params },\n          'query': { ...route.query }\n        }\n        this.$store.state.contentTabs = this.$store.state.contentTabs.concat(tab)\n      }\n      this.$store.state.sidebarMenuActiveName = tab.menuId\n      this.$store.state.contentTabsActiveName = tab.name\n    },\n    // 获取当前管理员信息\n    getUserInfo () {\n      return this.$http.get('/sys/user/info').then(({ data: res }) => {\n        if (res.code !== 0) {\n          return this.$message.error(res.msg)\n        }\n        this.$store.state.user.id = res.data.id\n        this.$store.state.user.name = res.data.username\n        this.$store.state.user.superAdmin = res.data.superAdmin\n      }).catch(() => {})\n    },\n    // 获取权限\n    getPermissions () {\n      return this.$http.get('/sys/menu/permissions').then(({ data: res }) => {\n        if (res.code !== 0) {\n          return this.$message.error(res.msg)\n        }\n        window.SITE_CONFIG['permissions'] = res.data\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n"]}]}